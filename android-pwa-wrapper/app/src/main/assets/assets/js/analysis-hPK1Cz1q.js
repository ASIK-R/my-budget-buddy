import{j as e,e as H,D as J,f as K}from"./charts-BciV_co-.js";import{r as o}from"./vendor-C6QSnSy8.js";import{u as Q}from"./dashboard-BxLSlvrI.js";import{b as v,e as f,c as $,d as S,g as O,h as T,i as A,j as E,p as y,a as R,f as u,k as V,l as X,s as _}from"./utils-isDzWD96.js";import{c as w,e as U,j as F,i as ee,F as Y,C as I,D as ae,h as se,k as te}from"./icons-CfTck2df.js";import{m as re}from"./animation-1uu9_pmp.js";const ge=()=>{const{transactions:x,wallets:D,budgets:M}=Q(),[h,L]=o.useState("monthly"),[b,z]=o.useState("trends"),[j,W]=o.useState("all"),p=o.useMemo(()=>{const a=new Date;let r,i;switch(h){case"daily":r=A(a),i=E(a);break;case"weekly":r=O(a,{weekStartsOn:1}),i=T(a,{weekStartsOn:1});break;case"monthly":r=v(a),i=f(a);break;case"yearly":r=$(a),i=S(a);break;default:r=v(a),i=f(a)}return x.filter(l=>{const c=y(l.date);return c>=r&&c<=i})},[x,h]),n=o.useMemo(()=>{const a=p.filter(t=>t.type==="income").reduce((t,s)=>t+s.amount,0),r=p.filter(t=>t.type==="expense").reduce((t,s)=>t+s.amount,0),i=a-r,l=a===0?0:Math.round(i/a*100),c=p.filter(t=>t.type==="expense").reduce((t,s)=>(t[s.category]=(t[s.category]||0)+s.amount,t),{}),d=D.reduce((t,s)=>(t[s.name]=s.balance,t),{}),g=x.filter(t=>t.recurring).reduce((t,s)=>(t[s.category]||(t[s.category]=[]),t[s.category].push(s),t),{}),k=M.map(t=>{const s=p.filter(m=>m.type==="expense"&&m.category===t.category).reduce((m,P)=>m+P.amount,0);return{category:t.category,budget:t.limit,actual:s,utilization:t.limit>0?Math.round(s/t.limit*100):0}});return{income:a,expense:r,savings:i,savingsRate:l,categoryExpenses:c,walletBalances:d,recurringTransactions:g,budgetUtilization:k}},[p,D,M]),N=o.useMemo(()=>{const a=[],r=[],i=[];for(let l=5;l>=0;l--){let c,d,g;switch(h){case"daily":{const s=_(new Date,l);c=u(s,"MMM dd"),d=A(s),g=E(s);break}case"weekly":{const s=X(new Date,l);c=`Week ${u(s,"ww")}`,d=O(s,{weekStartsOn:1}),g=T(s,{weekStartsOn:1});break}case"monthly":{const s=R(new Date,l);c=u(s,"MMM yy"),d=v(s),g=f(s);break}case"yearly":{const s=V(new Date,l);c=u(s,"yyyy"),d=$(s),g=S(s);break}default:{const s=R(new Date,l);c=u(s,"MMM yy"),d=v(s),g=f(s)}}a.push(c);const k=x.filter(s=>s.type==="income"&&y(s.date)>=d&&y(s.date)<=g).reduce((s,m)=>s+m.amount,0),t=x.filter(s=>s.type==="expense"&&y(s.date)>=d&&y(s.date)<=g).reduce((s,m)=>s+m.amount,0);r.push(k),i.push(t)}return{periods:a,incomeData:r,expenseData:i}},[x,h]),B=o.useMemo(()=>{const a=Object.keys(n.categoryExpenses),r=a.map(i=>n.categoryExpenses[i]);return{labels:a,datasets:[{data:r,backgroundColor:["rgba(99, 102, 241, 0.8)","rgba(239, 68, 68, 0.8)","rgba(34, 197, 94, 0.8)","rgba(251, 191, 36, 0.8)","rgba(168, 85, 247, 0.8)","rgba(236, 72, 153, 0.8)","rgba(59, 130, 246, 0.8)","rgba(14, 165, 233, 0.8)"],borderWidth:0,hoverOffset:12}]}},[n.categoryExpenses]),q=o.useMemo(()=>{const a=n.budgetUtilization.map(i=>i.category),r=n.budgetUtilization.map(i=>i.utilization);return n.budgetUtilization.map(i=>i.budget),{labels:a,datasets:[{label:"Budget Utilization %",data:r,backgroundColor:"rgba(99, 102, 241, 0.8)",borderColor:"rgba(99, 102, 241, 1)",borderWidth:1}]}},[n.budgetUtilization]),Z=o.useMemo(()=>{const a=[];if(n.savingsRate>=20?a.push({type:"positive",message:`Great job! You're saving ${n.savingsRate}% of your income.`,icon:w}):a.push({type:"suggestion",message:`Your savings rate is ${n.savingsRate}%. Try to aim for at least 20%.`,icon:U}),n.expense>n.income?a.push({type:"warning",message:"Expenses exceeded income in the selected period. Consider reviewing recurring costs.",icon:F}):a.push({type:"positive",message:"You maintained positive cash flow in the selected period.",icon:w}),Object.keys(n.categoryExpenses).length>0){const l=Object.entries(n.categoryExpenses).sort(([,c],[,d])=>d-c)[0];a.push({type:"info",message:`Top spending category: ${l[0]} ($${l[1].toFixed(2)})`,icon:ee})}else a.push({type:"info",message:"No expense categories yet. Track your spending to get insights.",icon:Y});const r=n.budgetUtilization.filter(l=>l.utilization>100);if(r.length>0){const l=r[0].category,c=r[0].actual-r[0].budget;a.push({type:"warning",message:`You've exceeded your budget for ${l} by $${c.toFixed(2)}.`,icon:F})}const i=Object.keys(n.recurringTransactions).length;return i>0&&a.push({type:"info",message:`You have ${i} recurring transaction categories. Review them regularly.`,icon:I}),a},[n]),C=o.useMemo(()=>b!=="statements"?[]:p.filter(a=>j==="all"||a.category===j).sort((a,r)=>y(r.date)-y(a.date)),[p,b,j]),G=o.useMemo(()=>["all",...[...new Set(x.map(r=>r.category))]],[x]);return e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"section-header",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"section-title",children:"Financial Analysis"}),e.jsx("p",{className:"section-subtitle",children:"Detailed insights into your financial patterns"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:h,onChange:a=>L(a.target.value),className:"input pl-10 pr-8 py-2",children:[e.jsx("option",{value:"daily",children:"Daily"}),e.jsx("option",{value:"weekly",children:"Weekly"}),e.jsx("option",{value:"monthly",children:"Monthly"}),e.jsx("option",{value:"yearly",children:"Yearly"})]}),e.jsx(I,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:16})]}),e.jsxs("div",{className:"flex rounded-lg border border-gray-300 dark:border-gray-600 overflow-hidden",children:[e.jsx("button",{onClick:()=>z("trends"),className:`px-4 py-2 text-sm font-medium transition-colors ${b==="trends"?"bg-primary-500 text-white":"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:"Trends"}),e.jsx("button",{onClick:()=>z("statements"),className:`px-4 py-2 text-sm font-medium transition-colors ${b==="statements"?"bg-primary-500 text-white":"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:"Statements"})]})]})]}),b==="trends"?e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"stat-card",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"stat-card-title",children:"Total Income"}),e.jsxs("p",{className:"stat-card-value text-success-500",children:["$",n.income.toLocaleString()]})]}),e.jsx("div",{className:"stat-card-icon bg-success-100 dark:bg-success-900/30 text-success-500",children:e.jsx(w,{size:24})})]})}),e.jsx("div",{className:"stat-card",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"stat-card-title",children:"Total Expenses"}),e.jsxs("p",{className:"stat-card-value text-error-500",children:["$",n.expense.toLocaleString()]})]}),e.jsx("div",{className:"stat-card-icon bg-error-100 dark:bg-error-900/30 text-error-500",children:e.jsx(U,{size:24})})]})}),e.jsx("div",{className:"stat-card",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"stat-card-title",children:"Net Savings"}),e.jsxs("p",{className:"stat-card-value text-secondary-500",children:["$",n.savings.toLocaleString()]})]}),e.jsx("div",{className:"stat-card-icon bg-secondary-100 dark:bg-secondary-900/30 text-secondary-500",children:e.jsx(ae,{size:24})})]})}),e.jsx("div",{className:"stat-card",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"stat-card-title",children:"Savings Rate"}),e.jsxs("p",{className:"stat-card-value text-purple-500",children:[n.savingsRate,"%"]})]}),e.jsx("div",{className:"stat-card-icon bg-purple-100 dark:bg-purple-900/30 text-purple-500",children:e.jsx(se,{size:24})})]})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"card-title",children:"Financial Insights"})}),e.jsx("div",{className:"card-content",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Z.map((a,r)=>{const i=a.icon;return e.jsx("div",{className:`p-4 rounded-lg border ${a.type==="positive"?"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800":a.type==="warning"?"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-200 dark:border-yellow-800":a.type==="suggestion"?"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800":"bg-gray-50 dark:bg-gray-800 border-gray-200 dark:border-gray-700"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(i,{size:20,className:a.type==="positive"?"text-green-600 dark:text-green-400":a.type==="warning"?"text-yellow-600 dark:text-yellow-400":a.type==="suggestion"?"text-blue-600 dark:text-blue-400":"text-gray-600 dark:text-gray-400"}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:a.message})]})},r)})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"card-title",children:"Income vs Expenses Trend"})}),e.jsx("div",{className:"card-content",children:e.jsx("div",{className:"h-80",children:e.jsx(H,{data:{labels:N.periods,datasets:[{label:"Income",data:N.incomeData,borderColor:"rgb(34, 197, 94)",backgroundColor:"rgba(34, 197, 94, 0.1)",tension:.4,fill:!0},{label:"Expenses",data:N.expenseData,borderColor:"rgb(239, 68, 68)",backgroundColor:"rgba(239, 68, 68, 0.1)",tension:.4,fill:!0}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0}}}})})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"card-title",children:"Spending by Category"})}),e.jsx("div",{className:"card-content",children:e.jsx("div",{className:"h-80",children:e.jsx(J,{data:B,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}}}})})})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"card-title",children:"Budget Utilization"})}),e.jsxs("div",{className:"card-content",children:[e.jsx("div",{className:"h-80",children:e.jsx(K,{data:q,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0,max:100,ticks:{callback:function(a){return a+"%"}}}}}})}),e.jsx("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-3 gap-4",children:n.budgetUtilization.map((a,r)=>e.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:a.category}),e.jsxs("span",{className:`font-semibold ${a.utilization>100?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400"}`,children:[a.utilization,"%"]})]}),e.jsx("div",{className:"mt-2 w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${a.utilization>100?"bg-red-500":a.utilization>80?"bg-yellow-500":"bg-green-500"}`,style:{width:`${Math.min(a.utilization,100)}%`}})}),e.jsxs("div",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:["$",a.actual.toFixed(2)," of $",a.budget.toFixed(2)]})]},r))})]})]})]}):e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsx("h3",{className:"card-title",children:"Financial Statements"}),e.jsx("div",{className:"flex gap-2",children:e.jsxs("div",{className:"relative",children:[e.jsx("select",{value:j,onChange:a=>W(a.target.value),className:"input pl-10 pr-8 py-2",children:G.map(a=>e.jsx("option",{value:a,children:a==="all"?"All Categories":a},a))}),e.jsx(te,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:16})]})})]}),e.jsx("div",{className:"card-content",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table table-bordered w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700 dark:text-gray-300 bg-gray-50 dark:bg-gray-700/50",children:"Date"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700 dark:text-gray-300 bg-gray-50 dark:bg-gray-700/50",children:"Description"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700 dark:text-gray-300 bg-gray-50 dark:bg-gray-700/50",children:"Category"}),e.jsx("th",{className:"text-right py-3 px-4 font-semibold text-gray-700 dark:text-gray-300 bg-gray-50 dark:bg-gray-700/50",children:"Amount"})]})}),e.jsx("tbody",{children:C.length>0?C.map(a=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/40",children:[e.jsx("td",{className:"py-3 px-4 text-gray-600 dark:text-gray-300",children:u(y(a.date),"MMM dd, yyyy")}),e.jsx("td",{className:"py-3 px-4 text-gray-600 dark:text-gray-300",children:a.description}),e.jsx("td",{className:"py-3 px-4 text-gray-600 dark:text-gray-300",children:e.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-gray-100 dark:bg-gray-700/50",children:a.category})}),e.jsxs("td",{className:`py-3 px-4 text-right font-medium ${a.type==="income"?"text-success-600 dark:text-success-300":"text-error-600 dark:text-error-300"}`,children:[a.type==="income"?"+":"-","$",a.amount.toLocaleString()]})]},a.id)):e.jsx("tr",{children:e.jsxs("td",{colSpan:"4",className:"py-12 text-center text-gray-500 dark:text-gray-400",children:[e.jsx(Y,{size:48,className:"mx-auto text-gray-300 dark:text-gray-500 mb-4"}),e.jsx("p",{className:"dark:text-gray-400",children:"No transactions found for the selected period and category"})]})})})]})})})]})]})};export{ge as default};
